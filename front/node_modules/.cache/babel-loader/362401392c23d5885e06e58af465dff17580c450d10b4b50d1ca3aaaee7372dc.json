{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\yusas\\\\Desktop\\\\online\\\\front\\\\src\\\\pages\\\\JournalPage.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useMemo, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport Button from '../components/ui/Button';\nimport Card from '../components/ui/Card';\nimport { useAuth } from '../auth/AuthContext';\nimport { getAttendanceJournal, getGradesJournal, setAttendance, setGrade } from '../api/journal';\nimport { getDisciplines } from '../api/disciplines';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction iso(d) {\n  return d.toISOString().slice(0, 10);\n}\nfunction addDays(d, n) {\n  const x = new Date(d.getTime());\n  x.setDate(x.getDate() + n);\n  return x;\n}\nexport default function JournalPage() {\n  _s();\n  var _modeOptions$find, _groupOptions$find;\n  const {\n    user\n  } = useAuth();\n  const navigate = useNavigate();\n  const modeOptions = useMemo(() => [{\n    value: 'attendance',\n    label: 'Посещаемость'\n  }, {\n    value: 'grades',\n    label: 'Успеваемость'\n  }], []);\n  const groupOptions = useMemo(() => [{\n    id: 1,\n    label: 'Группа 22-FT-1'\n  }, {\n    id: 2,\n    label: 'Группа 22-FT-2'\n  }, {\n    id: 3,\n    label: 'Группа 22-FT-3'\n  }], []);\n  const [mode, setMode] = useState(modeOptions[0].value);\n  const [groupId, setGroupId] = useState(groupOptions[1].id);\n  const [disciplineId, setDisciplineId] = useState(null);\n  const canEdit = (user === null || user === void 0 ? void 0 : user.role) === 'teacher';\n  const today = useMemo(() => new Date(), []);\n  const days = useMemo(() => {\n    const out = [];\n    for (let i = 0; i < 3; i += 1) {\n      out.push(iso(addDays(today, i * 7)));\n    }\n    return out;\n  }, [today]);\n  const [students, setStudents] = useState([]);\n  const [attendance, setAttendanceState] = useState({});\n  const [loading, setLoading] = useState(false);\n  const [picker, setPicker] = useState(null);\n  const [groupPickerOpen, setGroupPickerOpen] = useState(false);\n  const [topics, setTopics] = useState([]);\n  const [grades, setGradesState] = useState({});\n  const [gradePicker, setGradePicker] = useState(null);\n  useEffect(() => {\n    let alive = true;\n    async function loadDisciplines() {\n      try {\n        const list = await getDisciplines();\n        if (!alive) return;\n        if (Array.isArray(list) && list.length) {\n          setDisciplineId(list[0].id);\n        }\n      } catch (_) {\n        // ignore\n      }\n    }\n    if (user !== null && user !== void 0 && user.role) loadDisciplines();\n    return () => {\n      alive = false;\n    };\n  }, [user === null || user === void 0 ? void 0 : user.role]);\n  useEffect(() => {\n    if ((user === null || user === void 0 ? void 0 : user.role) === 'student' && user.group_id) {\n      setGroupId(user.group_id);\n    }\n  }, [user === null || user === void 0 ? void 0 : user.group_id, user === null || user === void 0 ? void 0 : user.role]);\n  useEffect(() => {\n    let alive = true;\n    async function load() {\n      setLoading(true);\n      try {\n        const res = await getAttendanceJournal({\n          groupId,\n          disciplineId,\n          days\n        });\n        if (!alive) return;\n        const nextStudents = ((res === null || res === void 0 ? void 0 : res.rows) || []).map(r => ({\n          id: r.student.id,\n          fio: r.student.full_name\n        }));\n        const nextAttendance = {};\n        for (const r of (res === null || res === void 0 ? void 0 : res.rows) || []) {\n          nextAttendance[r.student.id] = {\n            ...(r.statuses || {})\n          };\n        }\n        setStudents(nextStudents);\n        setAttendanceState(nextAttendance);\n      } catch (_) {\n        if (alive) setAttendanceState({});\n      } finally {\n        if (alive) setLoading(false);\n      }\n    }\n    if ((user === null || user === void 0 ? void 0 : user.role) === 'teacher' && mode === 'attendance' && disciplineId) load();\n    if ((user === null || user === void 0 ? void 0 : user.role) === 'student' && mode === 'attendance' && disciplineId) load();\n    return () => {\n      alive = false;\n    };\n  }, [days, disciplineId, groupId, mode, user === null || user === void 0 ? void 0 : user.role]);\n  useEffect(() => {\n    let alive = true;\n    async function loadGrades() {\n      setLoading(true);\n      try {\n        const res = await getGradesJournal({\n          groupId,\n          disciplineId\n        });\n        if (!alive) return;\n        const nextTopics = ((res === null || res === void 0 ? void 0 : res.topics) || []).map(t => ({\n          id: t.topic_id,\n          title: t.title,\n          maxPoints: t.max_points\n        }));\n        const nextStudents = ((res === null || res === void 0 ? void 0 : res.rows) || []).map(r => ({\n          id: r.student.id,\n          fio: r.student.full_name\n        }));\n        const nextGrades = {};\n        for (const r of (res === null || res === void 0 ? void 0 : res.rows) || []) {\n          const m = {};\n          for (const [k, v] of Object.entries(r.points || {})) {\n            const s = String(v || '').trim().toLowerCase();\n            if (!s || s === 'не выставлено') {\n              m[Number(k)] = null;\n              continue;\n            }\n            const n = Number(String(v).split('/')[0]);\n            m[Number(k)] = Number.isNaN(n) ? null : n;\n          }\n          nextGrades[r.student.id] = m;\n        }\n        setTopics(nextTopics);\n        setStudents(nextStudents);\n        setGradesState(nextGrades);\n      } catch (_) {\n        if (alive) setGradesState({});\n      } finally {\n        if (alive) setLoading(false);\n      }\n    }\n    if ((user === null || user === void 0 ? void 0 : user.role) === 'teacher' && mode === 'grades' && disciplineId) loadGrades();\n    if ((user === null || user === void 0 ? void 0 : user.role) === 'student' && mode === 'grades' && disciplineId) loadGrades();\n    return () => {\n      alive = false;\n    };\n  }, [disciplineId, groupId, mode, user === null || user === void 0 ? void 0 : user.role]);\n  function statusLabel(s) {\n    if (s === 'присутствовал') return 'Присутствовал';\n    if (s === 'отсутствовал') return 'Отсутствовал';\n    if (s === 'уважительная причина') return 'Уважительная причина';\n    return 'Не выставлено';\n  }\n  function statusClass(s) {\n    if (s === 'присутствовал') return 'attCellPresent';\n    if (s === 'отсутствовал') return 'attCellAbsent';\n    if (s === 'уважительная причина') return 'attCellReason';\n    return 'attCellUnset';\n  }\n  async function applyStatus(studentId, day, status) {\n    setPicker(null);\n    setAttendanceState(prev => ({\n      ...prev,\n      [studentId]: {\n        ...(prev[studentId] || {}),\n        [day]: status\n      }\n    }));\n    try {\n      if (!disciplineId) return;\n      await setAttendance({\n        studentId,\n        disciplineId,\n        day,\n        status\n      });\n    } catch (_) {\n      // ignore\n    }\n  }\n  function gradeLabel(v) {\n    if (v === null || v === undefined || v === '') return 'Не выставлено';\n    return `${v}/5`;\n  }\n  function gradeClass(v) {\n    if (v === null || v === undefined || v === '') return 'attCellUnset';\n    const n = Number(v);\n    if (Number.isNaN(n)) return 'attCellUnset';\n    if (n >= 5) return 'attCellPresent';\n    if (n <= 0) return 'attCellAbsent';\n    return 'attCellReason';\n  }\n  async function applyGrade(studentId, topicId, points) {\n    setGradePicker(null);\n    const safePoints = points === null || points === undefined ? 0 : points;\n    setGradesState(prev => ({\n      ...prev,\n      [studentId]: {\n        ...(prev[studentId] || {}),\n        [topicId]: safePoints\n      }\n    }));\n    try {\n      if (!disciplineId) return;\n      await setGrade({\n        studentId,\n        disciplineId,\n        topicId,\n        points: safePoints\n      });\n    } catch (_) {\n      // ignore\n    }\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"journalPageOuter\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"disciplineSubHeader\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"disciplineSubHeaderInner\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"journalSubHeaderBar\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"disciplineBackBtn\",\n            type: \"button\",\n            onClick: () => navigate(-1),\n            \"aria-label\": \"\\u041D\\u0430\\u0437\\u0430\\u0434\",\n            children: \"\\u2190\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 231,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"journalSubHeaderTitle\",\n            children: \"\\u0416\\u0443\\u0440\\u043D\\u0430\\u043B\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 234,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 230,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 228,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"pageWrap journalPage\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"journalControls\",\n        style: {\n          gridTemplateColumns: `1.1fr repeat(${mode === 'attendance' ? days.length : topics.length}, 1fr)`\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"pillSelect journalControlsMode\",\n          type: \"button\",\n          onClick: () => setMode(m => m === 'attendance' ? 'grades' : 'attendance'),\n          children: [((_modeOptions$find = modeOptions.find(x => x.value === mode)) === null || _modeOptions$find === void 0 ? void 0 : _modeOptions$find.label) || modeOptions[0].label, /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"pillArrow\",\n            \"aria-hidden\": \"true\",\n            children: \"\\u25BE\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 250,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 244,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"pillSelect journalControlsGroup\",\n          type: \"button\",\n          onClick: () => canEdit ? setGroupPickerOpen(true) : null,\n          children: [((_groupOptions$find = groupOptions.find(x => x.id === groupId)) === null || _groupOptions$find === void 0 ? void 0 : _groupOptions$find.label) || groupOptions[1].label, /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"pillArrow\",\n            \"aria-hidden\": \"true\",\n            children: \"\\u25BE\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 258,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 9\n      }, this), mode === 'attendance' ? /*#__PURE__*/_jsxDEV(Card, {\n        className: \"sectionCard journalAttendCard\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"attHeader\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"attHeaderCell attHeaderFio\",\n            children: \"\\u0424\\u0418\\u041E\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 265,\n            columnNumber: 15\n          }, this), days.map(d => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"attHeaderCell\",\n            children: new Date(d).toLocaleDateString('ru-RU', {\n              day: 'numeric',\n              month: 'long'\n            })\n          }, d, false, {\n            fileName: _jsxFileName,\n            lineNumber: 267,\n            columnNumber: 17\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"attBody\",\n          children: [loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"muted\",\n            children: \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 272,\n            columnNumber: 26\n          }, this) : null, (canEdit ? students : students.filter(s => s.id === (user === null || user === void 0 ? void 0 : user.student_id))).map(st => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"attRow\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"attFioCell\",\n              children: st.fio\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 275,\n              columnNumber: 19\n            }, this), days.map(d => {\n              var _attendance$st$id;\n              const val = attendance === null || attendance === void 0 ? void 0 : (_attendance$st$id = attendance[st.id]) === null || _attendance$st$id === void 0 ? void 0 : _attendance$st$id[d];\n              return /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                className: `attCell ${statusClass(val)}`,\n                onClick: () => canEdit ? setPicker({\n                  studentId: st.id,\n                  day: d\n                }) : null,\n                children: statusLabel(val)\n              }, `${st.id}_${d}`, false, {\n                fileName: _jsxFileName,\n                lineNumber: 279,\n                columnNumber: 23\n              }, this);\n            })]\n          }, st.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 274,\n            columnNumber: 17\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 271,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(Card, {\n        className: \"sectionCard journalAttendCard\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"attHeader\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"attHeaderCell attHeaderFio\",\n            children: \"\\u0424\\u0418\\u041E\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 296,\n            columnNumber: 15\n          }, this), topics.map(t => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"attHeaderCell\",\n            children: t.title\n          }, t.id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 298,\n            columnNumber: 17\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 295,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"attBody\",\n          children: [loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"muted\",\n            children: \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 303,\n            columnNumber: 26\n          }, this) : null, (canEdit ? students : students.filter(s => s.id === (user === null || user === void 0 ? void 0 : user.student_id))).map(st => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"attRow\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"attFioCell\",\n              children: st.fio\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 306,\n              columnNumber: 19\n            }, this), topics.map(t => {\n              var _grades$st$id;\n              const val = grades === null || grades === void 0 ? void 0 : (_grades$st$id = grades[st.id]) === null || _grades$st$id === void 0 ? void 0 : _grades$st$id[t.id];\n              return /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                className: `attCell ${gradeClass(val)}`,\n                onClick: () => canEdit ? setGradePicker({\n                  studentId: st.id,\n                  topicId: t.id\n                }) : null,\n                children: gradeLabel(val)\n              }, `${st.id}_${t.id}`, false, {\n                fileName: _jsxFileName,\n                lineNumber: 310,\n                columnNumber: 23\n              }, this);\n            })]\n          }, st.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 305,\n            columnNumber: 17\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 302,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 294,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        className: \"wideBtn\",\n        onClick: () => navigate('/disciplines'),\n        children: \"\\u041F\\u0435\\u0440\\u0435\\u0439\\u0442\\u0438 \\u0432 \\u0434\\u0438\\u0441\\u0446\\u0438\\u043F\\u043B\\u0438\\u043D\\u0443\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 326,\n        columnNumber: 9\n      }, this), picker ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"attPickerOverlay\",\n        role: \"dialog\",\n        \"aria-modal\": \"true\",\n        onClick: () => setPicker(null),\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"attPicker\",\n          onClick: e => e.stopPropagation(),\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"attPickerHead\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"attPickerTitle\",\n              children: \"\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u0441\\u0442\\u0430\\u0442\\u0443\\u0441\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 332,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"attPickerClose\",\n              type: \"button\",\n              onClick: () => setPicker(null),\n              \"aria-label\": \"\\u0417\\u0430\\u043A\\u0440\\u044B\\u0442\\u044C\",\n              children: \"\\xD7\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 333,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 331,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"attPickerGrid\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              className: \"attPickBtn\",\n              onClick: () => applyStatus(picker.studentId, picker.day, 'присутствовал'),\n              children: \"\\u041F\\u0440\\u0438\\u0441\\u0443\\u0442\\u0441\\u0442\\u0432\\u043E\\u0432\\u0430\\u043B\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 338,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              className: \"attPickBtn\",\n              onClick: () => applyStatus(picker.studentId, picker.day, 'отсутствовал'),\n              children: \"\\u041E\\u0442\\u0441\\u0443\\u0442\\u0441\\u0442\\u0432\\u043E\\u0432\\u0430\\u043B\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 341,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              className: \"attPickBtn\",\n              onClick: () => applyStatus(picker.studentId, picker.day, 'уважительная причина'),\n              children: \"\\u0423\\u0432\\u0430\\u0436\\u0438\\u0442\\u0435\\u043B\\u044C\\u043D\\u0430\\u044F \\u043F\\u0440\\u0438\\u0447\\u0438\\u043D\\u0430\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 344,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              className: \"attPickBtn\",\n              onClick: () => applyStatus(picker.studentId, picker.day, 'не выставлено'),\n              children: \"\\u041D\\u0435 \\u0432\\u044B\\u0441\\u0442\\u0430\\u0432\\u043B\\u0435\\u043D\\u043E\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 347,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 337,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 330,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 329,\n        columnNumber: 11\n      }, this) : null, gradePicker ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"attPickerOverlay\",\n        role: \"dialog\",\n        \"aria-modal\": \"true\",\n        onClick: () => setGradePicker(null),\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"attPicker\",\n          onClick: e => e.stopPropagation(),\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"attPickerHead\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"attPickerTitle\",\n              children: \"\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u0431\\u0430\\u043B\\u043B\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 359,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"attPickerClose\",\n              type: \"button\",\n              onClick: () => setGradePicker(null),\n              \"aria-label\": \"\\u0417\\u0430\\u043A\\u0440\\u044B\\u0442\\u044C\",\n              children: \"\\xD7\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 360,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 358,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"attPickerGrid\",\n            children: [[0, 1, 2, 3, 4, 5].map(p => /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              className: \"attPickBtn\",\n              onClick: () => applyGrade(gradePicker.studentId, gradePicker.topicId, p),\n              children: p\n            }, p, false, {\n              fileName: _jsxFileName,\n              lineNumber: 366,\n              columnNumber: 19\n            }, this)), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              className: \"attPickBtn\",\n              onClick: () => applyGrade(gradePicker.studentId, gradePicker.topicId, 0),\n              children: \"\\u041D\\u0435 \\u0432\\u044B\\u0441\\u0442\\u0430\\u0432\\u043B\\u0435\\u043D\\u043E\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 375,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 364,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 357,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 356,\n        columnNumber: 11\n      }, this) : null, groupPickerOpen ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"attPickerOverlay\",\n        role: \"dialog\",\n        \"aria-modal\": \"true\",\n        onClick: () => setGroupPickerOpen(false),\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"attPicker\",\n          onClick: e => e.stopPropagation(),\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"attPickerHead\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"attPickerTitle\",\n              children: \"\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u0433\\u0440\\u0443\\u043F\\u043F\\u0443\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 387,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"attPickerClose\",\n              type: \"button\",\n              onClick: () => setGroupPickerOpen(false),\n              \"aria-label\": \"\\u0417\\u0430\\u043A\\u0440\\u044B\\u0442\\u044C\",\n              children: \"\\xD7\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 388,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 386,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"attPickerGrid\",\n            children: groupOptions.map(g => /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              className: \"attPickBtn\",\n              onClick: () => {\n                setGroupId(g.id);\n                setGroupPickerOpen(false);\n              },\n              children: g.label\n            }, g.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 394,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 392,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 385,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 384,\n        columnNumber: 11\n      }, this) : null]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 227,\n    columnNumber: 5\n  }, this);\n}\n_s(JournalPage, \"Ryv2784p6NFnkko/8b7HAgAziRs=\", false, function () {\n  return [useAuth, useNavigate];\n});\n_c = JournalPage;\nvar _c;\n$RefreshReg$(_c, \"JournalPage\");","map":{"version":3,"names":["React","useEffect","useMemo","useState","useNavigate","Button","Card","useAuth","getAttendanceJournal","getGradesJournal","setAttendance","setGrade","getDisciplines","jsxDEV","_jsxDEV","iso","d","toISOString","slice","addDays","n","x","Date","getTime","setDate","getDate","JournalPage","_s","_modeOptions$find","_groupOptions$find","user","navigate","modeOptions","value","label","groupOptions","id","mode","setMode","groupId","setGroupId","disciplineId","setDisciplineId","canEdit","role","today","days","out","i","push","students","setStudents","attendance","setAttendanceState","loading","setLoading","picker","setPicker","groupPickerOpen","setGroupPickerOpen","topics","setTopics","grades","setGradesState","gradePicker","setGradePicker","alive","loadDisciplines","list","Array","isArray","length","_","group_id","load","res","nextStudents","rows","map","r","student","fio","full_name","nextAttendance","statuses","loadGrades","nextTopics","t","topic_id","title","maxPoints","max_points","nextGrades","m","k","v","Object","entries","points","s","String","trim","toLowerCase","Number","split","isNaN","statusLabel","statusClass","applyStatus","studentId","day","status","prev","gradeLabel","undefined","gradeClass","applyGrade","topicId","safePoints","className","children","type","onClick","fileName","_jsxFileName","lineNumber","columnNumber","style","gridTemplateColumns","find","toLocaleDateString","month","filter","student_id","st","_attendance$st$id","val","_grades$st$id","e","stopPropagation","p","g","_c","$RefreshReg$"],"sources":["C:/Users/yusas/Desktop/online/front/src/pages/JournalPage.js"],"sourcesContent":["import React, { useEffect, useMemo, useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nimport Button from '../components/ui/Button';\r\nimport Card from '../components/ui/Card';\r\nimport { useAuth } from '../auth/AuthContext';\r\nimport { getAttendanceJournal, getGradesJournal, setAttendance, setGrade } from '../api/journal';\r\nimport { getDisciplines } from '../api/disciplines';\r\n\r\nfunction iso(d) {\r\n  return d.toISOString().slice(0, 10);\r\n}\r\n\r\nfunction addDays(d, n) {\r\n  const x = new Date(d.getTime());\r\n  x.setDate(x.getDate() + n);\r\n  return x;\r\n}\r\n\r\nexport default function JournalPage() {\r\n  const { user } = useAuth();\r\n  const navigate = useNavigate();\r\n\r\n  const modeOptions = useMemo(\r\n    () => [\r\n      { value: 'attendance', label: 'Посещаемость' },\r\n      { value: 'grades', label: 'Успеваемость' },\r\n    ],\r\n    []\r\n  );\r\n  const groupOptions = useMemo(\r\n    () => [\r\n      { id: 1, label: 'Группа 22-FT-1' },\r\n      { id: 2, label: 'Группа 22-FT-2' },\r\n      { id: 3, label: 'Группа 22-FT-3' },\r\n    ],\r\n    []\r\n  );\r\n\r\n  const [mode, setMode] = useState(modeOptions[0].value);\r\n  const [groupId, setGroupId] = useState(groupOptions[1].id);\r\n  const [disciplineId, setDisciplineId] = useState(null);\r\n  const canEdit = user?.role === 'teacher';\r\n\r\n  const today = useMemo(() => new Date(), []);\r\n  const days = useMemo(() => {\r\n    const out = [];\r\n    for (let i = 0; i < 3; i += 1) {\r\n      out.push(iso(addDays(today, i * 7)));\r\n    }\r\n    return out;\r\n  }, [today]);\r\n\r\n  const [students, setStudents] = useState([]);\r\n\r\n  const [attendance, setAttendanceState] = useState({});\r\n  const [loading, setLoading] = useState(false);\r\n  const [picker, setPicker] = useState(null);\r\n  const [groupPickerOpen, setGroupPickerOpen] = useState(false);\r\n\r\n  const [topics, setTopics] = useState([]);\r\n  const [grades, setGradesState] = useState({});\r\n  const [gradePicker, setGradePicker] = useState(null);\r\n\r\n  useEffect(() => {\r\n    let alive = true;\r\n    async function loadDisciplines() {\r\n      try {\r\n        const list = await getDisciplines();\r\n        if (!alive) return;\r\n        if (Array.isArray(list) && list.length) {\r\n          setDisciplineId(list[0].id);\r\n        }\r\n      } catch (_) {\r\n        // ignore\r\n      }\r\n    }\r\n\r\n    if (user?.role) loadDisciplines();\r\n    return () => {\r\n      alive = false;\r\n    };\r\n  }, [user?.role]);\r\n\r\n  useEffect(() => {\r\n    if (user?.role === 'student' && user.group_id) {\r\n      setGroupId(user.group_id);\r\n    }\r\n  }, [user?.group_id, user?.role]);\r\n\r\n  useEffect(() => {\r\n    let alive = true;\r\n    async function load() {\r\n      setLoading(true);\r\n      try {\r\n        const res = await getAttendanceJournal({ groupId, disciplineId, days });\r\n        if (!alive) return;\r\n        const nextStudents = (res?.rows || []).map((r) => ({ id: r.student.id, fio: r.student.full_name }));\r\n        const nextAttendance = {};\r\n        for (const r of res?.rows || []) {\r\n          nextAttendance[r.student.id] = { ...(r.statuses || {}) };\r\n        }\r\n        setStudents(nextStudents);\r\n        setAttendanceState(nextAttendance);\r\n      } catch (_) {\r\n        if (alive) setAttendanceState({});\r\n      } finally {\r\n        if (alive) setLoading(false);\r\n      }\r\n    }\r\n\r\n    if (user?.role === 'teacher' && mode === 'attendance' && disciplineId) load();\r\n    if (user?.role === 'student' && mode === 'attendance' && disciplineId) load();\r\n    return () => {\r\n      alive = false;\r\n    };\r\n  }, [days, disciplineId, groupId, mode, user?.role]);\r\n\r\n  useEffect(() => {\r\n    let alive = true;\r\n    async function loadGrades() {\r\n      setLoading(true);\r\n      try {\r\n        const res = await getGradesJournal({ groupId, disciplineId });\r\n        if (!alive) return;\r\n        const nextTopics = (res?.topics || []).map((t) => ({ id: t.topic_id, title: t.title, maxPoints: t.max_points }));\r\n        const nextStudents = (res?.rows || []).map((r) => ({ id: r.student.id, fio: r.student.full_name }));\r\n\r\n        const nextGrades = {};\r\n        for (const r of res?.rows || []) {\r\n          const m = {};\r\n          for (const [k, v] of Object.entries(r.points || {})) {\r\n            const s = String(v || '').trim().toLowerCase();\r\n            if (!s || s === 'не выставлено') {\r\n              m[Number(k)] = null;\r\n              continue;\r\n            }\r\n            const n = Number(String(v).split('/')[0]);\r\n            m[Number(k)] = Number.isNaN(n) ? null : n;\r\n          }\r\n          nextGrades[r.student.id] = m;\r\n        }\r\n\r\n        setTopics(nextTopics);\r\n        setStudents(nextStudents);\r\n        setGradesState(nextGrades);\r\n      } catch (_) {\r\n        if (alive) setGradesState({});\r\n      } finally {\r\n        if (alive) setLoading(false);\r\n      }\r\n    }\r\n\r\n    if (user?.role === 'teacher' && mode === 'grades' && disciplineId) loadGrades();\r\n    if (user?.role === 'student' && mode === 'grades' && disciplineId) loadGrades();\r\n    return () => {\r\n      alive = false;\r\n    };\r\n  }, [disciplineId, groupId, mode, user?.role]);\r\n\r\n  function statusLabel(s) {\r\n    if (s === 'присутствовал') return 'Присутствовал';\r\n    if (s === 'отсутствовал') return 'Отсутствовал';\r\n    if (s === 'уважительная причина') return 'Уважительная причина';\r\n    return 'Не выставлено';\r\n  }\r\n\r\n  function statusClass(s) {\r\n    if (s === 'присутствовал') return 'attCellPresent';\r\n    if (s === 'отсутствовал') return 'attCellAbsent';\r\n    if (s === 'уважительная причина') return 'attCellReason';\r\n    return 'attCellUnset';\r\n  }\r\n\r\n  async function applyStatus(studentId, day, status) {\r\n    setPicker(null);\r\n    setAttendanceState((prev) => ({\r\n      ...prev,\r\n      [studentId]: {\r\n        ...(prev[studentId] || {}),\r\n        [day]: status,\r\n      },\r\n    }));\r\n\r\n    try {\r\n      if (!disciplineId) return;\r\n      await setAttendance({ studentId, disciplineId, day, status });\r\n    } catch (_) {\r\n      // ignore\r\n    }\r\n  }\r\n\r\n  function gradeLabel(v) {\r\n    if (v === null || v === undefined || v === '') return 'Не выставлено';\r\n    return `${v}/5`;\r\n  }\r\n\r\n  function gradeClass(v) {\r\n    if (v === null || v === undefined || v === '') return 'attCellUnset';\r\n    const n = Number(v);\r\n    if (Number.isNaN(n)) return 'attCellUnset';\r\n    if (n >= 5) return 'attCellPresent';\r\n    if (n <= 0) return 'attCellAbsent';\r\n    return 'attCellReason';\r\n  }\r\n\r\n  async function applyGrade(studentId, topicId, points) {\r\n    setGradePicker(null);\r\n    const safePoints = points === null || points === undefined ? 0 : points;\r\n    setGradesState((prev) => ({\r\n      ...prev,\r\n      [studentId]: {\r\n        ...(prev[studentId] || {}),\r\n        [topicId]: safePoints,\r\n      },\r\n    }));\r\n\r\n    try {\r\n      if (!disciplineId) return;\r\n      await setGrade({ studentId, disciplineId, topicId, points: safePoints });\r\n    } catch (_) {\r\n      // ignore\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"journalPageOuter\">\r\n      <div className=\"disciplineSubHeader\">\r\n        <div className=\"disciplineSubHeaderInner\">\r\n          <div className=\"journalSubHeaderBar\">\r\n            <button className=\"disciplineBackBtn\" type=\"button\" onClick={() => navigate(-1)} aria-label=\"Назад\">\r\n              ←\r\n            </button>\r\n            <div className=\"journalSubHeaderTitle\">Журнал</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"pageWrap journalPage\">\r\n        <div\r\n          className=\"journalControls\"\r\n          style={{ gridTemplateColumns: `1.1fr repeat(${mode === 'attendance' ? days.length : topics.length}, 1fr)` }}\r\n        >\r\n          <button\r\n            className=\"pillSelect journalControlsMode\"\r\n            type=\"button\"\r\n            onClick={() => setMode((m) => (m === 'attendance' ? 'grades' : 'attendance'))}\r\n          >\r\n            {modeOptions.find((x) => x.value === mode)?.label || modeOptions[0].label}\r\n            <span className=\"pillArrow\" aria-hidden=\"true\">▾</span>\r\n          </button>\r\n          <button\r\n            className=\"pillSelect journalControlsGroup\"\r\n            type=\"button\"\r\n            onClick={() => (canEdit ? setGroupPickerOpen(true) : null)}\r\n          >\r\n            {groupOptions.find((x) => x.id === groupId)?.label || groupOptions[1].label}\r\n            <span className=\"pillArrow\" aria-hidden=\"true\">▾</span>\r\n          </button>\r\n        </div>\r\n\r\n        {mode === 'attendance' ? (\r\n          <Card className=\"sectionCard journalAttendCard\">\r\n            <div className=\"attHeader\">\r\n              <div className=\"attHeaderCell attHeaderFio\">ФИО</div>\r\n              {days.map((d) => (\r\n                <div key={d} className=\"attHeaderCell\">{new Date(d).toLocaleDateString('ru-RU', { day: 'numeric', month: 'long' })}</div>\r\n              ))}\r\n            </div>\r\n\r\n            <div className=\"attBody\">\r\n              {loading ? <div className=\"muted\">Загрузка...</div> : null}\r\n              {(canEdit ? students : students.filter((s) => s.id === user?.student_id)).map((st) => (\r\n                <div key={st.id} className=\"attRow\">\r\n                  <div className=\"attFioCell\">{st.fio}</div>\r\n                  {days.map((d) => {\r\n                    const val = attendance?.[st.id]?.[d];\r\n                    return (\r\n                      <button\r\n                        key={`${st.id}_${d}`}\r\n                        type=\"button\"\r\n                        className={`attCell ${statusClass(val)}`}\r\n                        onClick={() => (canEdit ? setPicker({ studentId: st.id, day: d }) : null)}\r\n                      >\r\n                        {statusLabel(val)}\r\n                      </button>\r\n                    );\r\n                  })}\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </Card>\r\n        ) : (\r\n          <Card className=\"sectionCard journalAttendCard\">\r\n            <div className=\"attHeader\">\r\n              <div className=\"attHeaderCell attHeaderFio\">ФИО</div>\r\n              {topics.map((t) => (\r\n                <div key={t.id} className=\"attHeaderCell\">{t.title}</div>\r\n              ))}\r\n            </div>\r\n\r\n            <div className=\"attBody\">\r\n              {loading ? <div className=\"muted\">Загрузка...</div> : null}\r\n              {(canEdit ? students : students.filter((s) => s.id === user?.student_id)).map((st) => (\r\n                <div key={st.id} className=\"attRow\">\r\n                  <div className=\"attFioCell\">{st.fio}</div>\r\n                  {topics.map((t) => {\r\n                    const val = grades?.[st.id]?.[t.id];\r\n                    return (\r\n                      <button\r\n                        key={`${st.id}_${t.id}`}\r\n                        type=\"button\"\r\n                        className={`attCell ${gradeClass(val)}`}\r\n                        onClick={() => (canEdit ? setGradePicker({ studentId: st.id, topicId: t.id }) : null)}\r\n                      >\r\n                        {gradeLabel(val)}\r\n                      </button>\r\n                    );\r\n                  })}\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </Card>\r\n        )}\r\n\r\n        <Button className=\"wideBtn\" onClick={() => navigate('/disciplines')}>Перейти в дисциплину</Button>\r\n\r\n        {picker ? (\r\n          <div className=\"attPickerOverlay\" role=\"dialog\" aria-modal=\"true\" onClick={() => setPicker(null)}>\r\n            <div className=\"attPicker\" onClick={(e) => e.stopPropagation()}>\r\n              <div className=\"attPickerHead\">\r\n                <div className=\"attPickerTitle\">Выберите статус</div>\r\n                <button className=\"attPickerClose\" type=\"button\" onClick={() => setPicker(null)} aria-label=\"Закрыть\">\r\n                  ×\r\n                </button>\r\n              </div>\r\n              <div className=\"attPickerGrid\">\r\n                <button type=\"button\" className=\"attPickBtn\" onClick={() => applyStatus(picker.studentId, picker.day, 'присутствовал')}>\r\n                  Присутствовал\r\n                </button>\r\n                <button type=\"button\" className=\"attPickBtn\" onClick={() => applyStatus(picker.studentId, picker.day, 'отсутствовал')}>\r\n                  Отсутствовал\r\n                </button>\r\n                <button type=\"button\" className=\"attPickBtn\" onClick={() => applyStatus(picker.studentId, picker.day, 'уважительная причина')}>\r\n                  Уважительная причина\r\n                </button>\r\n                <button type=\"button\" className=\"attPickBtn\" onClick={() => applyStatus(picker.studentId, picker.day, 'не выставлено')}>\r\n                  Не выставлено\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        ) : null}\r\n\r\n        {gradePicker ? (\r\n          <div className=\"attPickerOverlay\" role=\"dialog\" aria-modal=\"true\" onClick={() => setGradePicker(null)}>\r\n            <div className=\"attPicker\" onClick={(e) => e.stopPropagation()}>\r\n              <div className=\"attPickerHead\">\r\n                <div className=\"attPickerTitle\">Выберите балл</div>\r\n                <button className=\"attPickerClose\" type=\"button\" onClick={() => setGradePicker(null)} aria-label=\"Закрыть\">\r\n                  ×\r\n                </button>\r\n              </div>\r\n              <div className=\"attPickerGrid\">\r\n                {[0, 1, 2, 3, 4, 5].map((p) => (\r\n                  <button\r\n                    key={p}\r\n                    type=\"button\"\r\n                    className=\"attPickBtn\"\r\n                    onClick={() => applyGrade(gradePicker.studentId, gradePicker.topicId, p)}\r\n                  >\r\n                    {p}\r\n                  </button>\r\n                ))}\r\n                <button type=\"button\" className=\"attPickBtn\" onClick={() => applyGrade(gradePicker.studentId, gradePicker.topicId, 0)}>\r\n                  Не выставлено\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        ) : null}\r\n\r\n        {groupPickerOpen ? (\r\n          <div className=\"attPickerOverlay\" role=\"dialog\" aria-modal=\"true\" onClick={() => setGroupPickerOpen(false)}>\r\n            <div className=\"attPicker\" onClick={(e) => e.stopPropagation()}>\r\n              <div className=\"attPickerHead\">\r\n                <div className=\"attPickerTitle\">Выберите группу</div>\r\n                <button className=\"attPickerClose\" type=\"button\" onClick={() => setGroupPickerOpen(false)} aria-label=\"Закрыть\">\r\n                  ×\r\n                </button>\r\n              </div>\r\n              <div className=\"attPickerGrid\">\r\n                {groupOptions.map((g) => (\r\n                  <button\r\n                    key={g.id}\r\n                    type=\"button\"\r\n                    className=\"attPickBtn\"\r\n                    onClick={() => {\r\n                      setGroupId(g.id);\r\n                      setGroupPickerOpen(false);\r\n                    }}\r\n                  >\r\n                    {g.label}\r\n                  </button>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        ) : null}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}